<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    
</body>


<script>

// [
//   [
//     {
//       "id": "65721e1303a29768d66c17e5",
//       "name": "Diskrete Mathematik",
//       "description": "Feedback-Kanal für DiMa",
//       "feedbackForms": [
//         {
//           "id": "65721e1303a29768d66c17e4",
//           "name": "Letzte Vorlesung",
//           "description": "Dies ist das Feedback zur letzten Vorlesung.",
//           "elements": [
//             {
//               "id": "65721e1303a29768d66c17e2",
//               "name": "Frage 1",
//               "description": "Wie fandest du die letzte Vorlesung auf einer Skala von 1 bis 5?",
//               "type": "STARS",
//               "results": []
//             },
//             {
//               "id": "65721e1303a29768d66c17e3",
//               "name": "Frage 2",
//               "description": "Würdest du die Vorlesung weiterempfehlen?",
//               "type": "YES_NO",
//               "results": []
//             }
//           ],
//           "status": "NOT_STARTED"
//         }
//       ]
//     }
//   ],
//   [
//     {
//       "id": "65721e1303a29768d66c17e6",
//       "username": "Johannes",
//       "hashedPassword": "password1"
//     },
//     {
//       "id": "65721e1303a29768d66c17e7",
//       "username": "Fabi",
//       "hashedPassword": "password2"
//     }
//   ]
// ]

        // @ServerEndpoint("/feedback/channel/{channelId}/form/{formId}/subscribe/{userId}")

    let webSocket = new WebSocket("ws://localhost:8080/feedback/channel/65721e1303a29768d66c17e5/form/65721e1303a29768d66c17e4/subscribe/6571b92fc08cda5aed6a7f53");

    webSocket.onopen = function(event) {
        console.log("Connection established!");
        send();
    };

    webSocket.onmessage = function(event) {
        console.log("Message received: " + event.data);
    };

    webSocket.onclose = function(event) {
        console.log("Connection closed!");
    };

    webSocket.onerror = function(event) {
        console.log("Error!");
    };

    function send() {

        // type feedbackSocketMessage = {
        //     "action": "CHANGE_FORM_STATUS" | "ADD_RESULT"
        //     "formStatus": null | "NOT_STARTED" | "STARTED" | "FINISHED"
        //     "resultElementId": null | string,
        //     "resultValue": null | string | number | boolean,
        //     "role": "STUDENT" | "PROF" | "SERVER"
        //     "userId": string | "SERVER"
        // }

        let sendObject = {
            "action": "CHANGE_FORM_STATUS",
            "formStatus": "FINISHED",
            "resultElementId": null,
            "resultValue": null,
            "role": "STUDENT",
            "userId": "6571b92fc08cda5aed6a7f53"
        }
        let sendObject2 = {
            "action": "ADD_RESULT",
            "formStatus": null,
            "resultElementId": "65721e1303a29768d66c17e2",
            "resultValue": "5",
            "role": "STUDENT",
            "userId": "6571b92fc08cda5aed6a7f53"
        }
        console.log("Sending: " + JSON.stringify(sendObject2));
        webSocket.send(JSON.stringify(sendObject2));
    }

    function close() {
        webSocket.close();
    }
    

</script>

</html>